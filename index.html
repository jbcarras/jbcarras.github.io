<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="static/css/editor.css">
    <link rel="stylesheet" id="dark-mode-style" href="static/css/dark.css" disabled>
    <link rel="shortcut icon" href="static/favicon.ico">
    <script src="static/js/editor.js" defer></script>
    <script src="static/js/canvas.js" defer></script>
    <title>Level Editor</title>
</head>
<body>
<div id="alert-container"></div>
<div id="zoom-box">
            <label for="zoom">Zoom</label>
            <input type="range" id="zoom" value="31" min="10" max="100" onchange="redrawCanvas(); manipulateCanvasMargin()">
            <label for="grid-scale">Grid Scale</label>
                <select id="grid-scale" onchange="gridScale = this.value; redrawCanvas()">
                    <option value="1">1 Tile</option>
                    <option value="2">1/2 Tile</option>
                    <option value="4">1/4 Tile</option>
                </select>
</div>
<div id="editor">
    <div id="level-container">
        <div id="csv-editor" style="display: none">
            <label for="csv-entry">CSV Entry</label>
            <textarea id="csv-entry" name="csv-entry"></textarea>
        </div>
        <canvas id="level-visual"></canvas>
    </div>
    <div id="secondary-container">
        <div id="settings">
            <h2>Settings</h2>
            <div id="visual-mode-controls">
                <label for="name">Level Name</label>
                <input id="name" name="name" type="text" oninput="{
                        const legal = /[a-z]|[0-9]|['!@#$^&()\-_+\[\]{}]/i
                        this.value = Array.from(this.value).filter((char) => {return legal.test(char)}).join('')
                    }">
                <br/>
                <label for="width">Width</label>
                <input id="width" name="width" type="number" value="12" min="1" size="3"
                       oninput="this.value = Math.max(this.value, 1); resizeLevel()">
                <br/>
                <label for="height">Height</label>
                <input id="height" name="height" type="number" value="8" min="1" size="3"
                       oninput="this.value = Math.max(this.value, 1); resizeLevel()">
                <br/>
                <label for="background-select">Background Select</label>
                <select id="background-select" name="background-select"></select>
                <br>
                <div id="background-options" style="display: none">
                    <label for="bg-filename">Background Filename</label>
                    <input id="bg-filename" name="bg-filename" type="text" value="Grass.png" onload="backgroundFname = this.value" onchange="backgroundFname = this.value">
                    <br/>
                    <label for="bg-tiled">Tiled Background</label>
                    <input id="bg-tiled" name="bg-tiled" type="checkbox" checked onload="bgTiled = this.checked" onclick="bgTiled = this.checked; document.getElementById('tile-controls').style.display = this.checked ? 'block' : 'none'">
                    <span id="tile-controls" style="display: none">
                        <br/>
                        <label for="bg-col">Tile Column</label>
                        <input id="bg-col" name="bg-col" type="number" value="0" min="0" size="3" oninput="this.value = Math.max(this.value, 0)">
                        <br/>
                        <label for="bg-row">Tile Row</label>
                        <input id="bg-row" name="bg-row" type="number" value="0" min="0" size="3" oninput="this.value = Math.max(this.value, 0)">
                    </span>
                </div>
            </div>
            <div id="global-controls">
                <button id="export">Export Level</button>
                <label for="level-import" style="display: none">Import from CSV</label>
                <input id="level-import" name="level-import" type="file" accept="text/csv" style="display: none"
                    onchange="importLevel(this.files[this.files.length - 1])">
                <button onclick="document.getElementById('level-import').click()">Import Level</button>
                <button id="reset">Reset</button>
                <br/>
                <label for="dark-mode">Dark Mode</label>
                <input id="dark-mode" name="dark-mode" type="checkbox"
                    onclick="setDarkMode(this.checked); document.styleSheets[0].insertRule('* {transition: background-color 0.25s linear, border 0.25s linear, box-shadow 0.25s linear}')">
                <br/>
                <label for="hints">Tile Location Hints</label>
                <select id="hints" onchange="redrawCanvas()">
                    <option value="always">Always</option>
                    <option value="ambiguous" selected>When Ambiguous</option>
                    <option value="never">Never</option>
                </select>
            </div>
            <hr/>
        </div>
        <div id="item-info-container">
            <div id="attributes-section">
            <h2>Level Editor</h2>
            <p class="center">Click on a tile to start drawing it.</p>
            <p class="center">Left Click - Draw</p>
            <p class="center">Right Click - Erase</p>
        </div>
            <div id="customizer" style="display: none">
                <label for="custom-parent">Parent</label>
                <br>
                <input id="custom-parent" name="Parent" type="text">
                <br>
                <label for="custom-name">Name</label>
                <br>
                <input id="custom-name" name="Name" type="text">
                <br>
                <label for="custom-color">Color</label>
                <input id="custom-color" name="custom-color" type="color" value="#A9A9A9" style="cursor: pointer;">
                <br/>
                <button id="custom-toolbar-add" name="Toolbar" onclick="customizerAdd()">Add to Palette</button>
                <br>
                <button id="export-custom" name="export-custom" onclick="exportCustom()">Export Custom Items</button>
                <br>
                <button id="import-custom" name="import-custom" onclick="document.getElementById('import-custom-file').click()" >Import Custom Items</button>
                <label for="import-custom-file" style="display: none">Import Custom Items</label>
                <input id="import-custom-file" name="import-custom-file" type="file" accept="application/json" style="display: none"
                   onchange="importCustom(this.files[this.files.length - 1])">
                <br>
            </div>
        </div>
        <br/>
        <hr/>
        <div id="toolbar-container">
            <div id="toolbar-settings">
                <label for="task">Progress</label>
                <select id="task" name="task"></select>
                <br/>
                <label for="type">Level Type</label>
                <select id="type" name="type"></select>
                <div id="custom-type-container" style="display: none">
                    <label for="type-name">Custom Type</label>
                    <input id="type-name" name="type-name" type="text">
                </div>

            </div>
            <div id="toolbar">
                <div class="toolbar-item" id="eraser-button" data-type="tool" style="background-image: url('static/tiles/Eraser.png')">Eraser</div>
                <div class="toolbar-item" id="player-button" data-type="tool" style="background-image: url('static/tiles/Player.png')">Player</div>
                <div class="toolbar-item" id="custom-button" data-type="tool" style="background-image: url('static/tiles/Custom.png')">Customizer</div>
                <div class="toolbar-item" id="csv-button" data-type="tool" style="background-image: url('static/tiles/BackgroundTool.png')">CSV Editor</div>
                <hr/>
            </div>
        </div>
        <hr/>
    </div>
</div>
</body>
</html>